Быстрый старт
=============

Библиотека Runn Me! Framework представляет собой набор интерфейсов, трейтов, классов и хелперов, предназначенных
для разработки веб- и консольных приложений на базе Runn Me! как микро-фреймворка. 

Шаг 1. Конфигурация
-------------------

Создайте конфигурацию приложения. По умолчанию, конечно, конфигурация может быть и пустой, но это - 
тривиальный случай, который нет смысла рассматривать.

Реальному веб-приложению потребуются, как минимум, контейнер (для управления сервисами) и роутер (для 
связи между запросом от клиента и кодом, который должен обработать такой запрос).

И для контейнера и для роутера имеются реализации по умолчанию, позволяющие вам не писать лишний код.
Но в то же время нужно отметить, что Runn Me! полагается на интерфейсы, а не на реализации. Это значит, 
что любая часть вашего приложения, включая такие "системные" объекты, как контейнер, роутер или даже сам объект приложения,
могут быть заменены на любую другую реализацию, реализующую тот же интерфейс.

**Пример простейшей конфигурации приложения:**

config.db:
```php 
return [
    'container' => [
        'class' => \Runn\Di\Container::class, 
    ],
    'router' => [
        'class' => \Runn\Framework\Router::class,
        'routes' => require __DIR__ . '/routes.php',
    ],
];
```

Шаг 2. Роутинг
--------------
Обратите внимание на то, что в конфигурации приложения мы предполагаем отдельно подключить файл со списокм роутов.

**Роут** - это выражение, способное преобразовать запрос от клиента в список действий, которые нужно предпринять для
обработки этого запроса.

В простейшем случае каждый роут можно представить в виде функции, принимающей запрос и возвращающей список действий.
Так и запишем в файле роутов:

routes.php:
```php
use Runn\Http\RequestInterface;
use Runn\Framework\Actions;

use App\Actions\IndexAction;

return [

    function (RequestInterface $request): ?Actions {
        if ($request->getUri()->getPath() === '/') {
            return new Actions([IndexAction::class]);
        }
    },

];
```

Таким образом мы определили, что запрос на отображение главной страницы нашего сайта будет
обрабатываться действием `IndexAction` - единственным в цепочке действий.

Шаг 3. Создание объекта приложения.
-----------------------------------

Давайте создадим объект веб-приложения!

index.php:
```php
use Runn\Core\Config;
use Runn\Framework\WebApplication;
use Runn\Fs\Files\PhpFile;

$config = new Config(
    new PhpFile('config.db') // Укажите тут путь к конфигу
);
$app = WebApplication::instance($config);
```

Шаг 4. Роутер и запуск действий.
--------------------------------

Теперь запустим роутер, передадим ему запрос от клиента и узнаем, какие действия будут предприняты в ответ на запрос:

```php
use Runn\Http\Request;

$request = Request::constructFromGlobals();
$router = $app->getRouter();
$actions = $router->handle($request);
```

Далее нам нужно подготовить пустой ответ, а затем, в зависимости от того, сумел ли роутер определить список действий, либо
модифицировать этот ответ кодом 404, либо передать его действиям для их работы. Ну и последним шагом - отправить ответ клиенту.

```php
use Runn\Http\Response;

$response = new Response();

if (null === $actions) {
    $response = $response->withStatus(404);
} else {
    $response = $actions($request, $response) ?? $response;
}

$response->send();
```

Шаг 5. Код действия.
--------------------

Ну что же, осталось написать собственно код действия - код, который примет запрос и сформирует ответ.

```php
namespace App\Actions;

use Runn\Http\RequestInterface;
use Runn\Framework\ActionInterface;
use Runn\Http\ResponseInterface;

class IndexAction implements ActionInterface
{
    public function __invoke(RequestInterface $request, ResponseInterface $response): ?ResponseInterface
    {
        $response->getBody()->write('Hello, world!');
        return $response;
    }
}
```

Готово! Веб-приложение можно запускать.